%--------------------
% Packages
% -------------------
\documentclass[12pt,a4paper]{article}

\input{my-bib-file/usepackage.tex} 
%\usepackage[utf8x]{inputenc}
% \usepackage[T1]{fontenc}
%\usepackage{gentium}
% \usepackage{mathptmx} % Use Times Font


%\usepackage[pdftex]{graphicx} % Required for including pictures
%\usepackage[swedish]{babel} % Swedish translations
%\usepackage[pdftex,linkcolor=black,pdfborder={0 0 0}]{hyperref} % Format links for pdf
%\usepackage{calc} % To reset the counter in the document after title page
%\usepackage{enumitem} % Includes lists

%\frenchspacing % No double spacing between sentences
% \linespread{1.2} % Set linespace
%\usepackage[a4paper, lmargin=0.1666\paperwidth, rmargin=0.1666\paperwidth, tmargin=0.1111\paperheight, bmargin=0.1111\paperheight]{geometry} %margins
%\usepackage{parskip}

%\usepackage[all]{nowidow} % Tries to remove widows
%\usepackage[protrusion=true,expansion=true]{microtype} % Improves typography, load after fontpackage is selected
%
%\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
%\usepackage{amsmath}
%\usepackage{amsfonts}
%\usepackage{braket}
%\usepackage{subcaption}
%
%\usepackage{tikz}
%%\usepackage{chngcntr}
%\usetikzlibrary{quantikz2}
%
%\usepackage[
%backend=biber,
%style=alphabetic,
%sorting=ynt
%]{biblatex}
%\addbibresource{sample.bib}
%
%\usepackage{lmodern}
%-----------------------
% Set pdf information and add title, fill in the fields
%-----------------------
% \hypersetup{ 	
% pdfsubject = {},
% pdftitle = {},
% pdfauthor = {}
% }

\usepackage{framed}
%\usepackage{advdate}
%\usepackage[colorlinks=true]{hyperref}
%\usepackage{cleveref}
%\crefname{figure}{\textbf{Figure}}{\textbf{Figure}}
%-----------------------
% Begin document
%----------------------



\title{ \begin{framed} Quantum Information Theory - 67749 \\ 
Recitation 2, \today \end{framed}  }
%\date{\today}
\date{\vspace{-5ex}}



\begin{document}

%\input{my-bib-file/sample.bib} 
\input{my-bib-file/newcommands.tex} 
%\begin{framed}
\maketitle{ }    
%\end{framed}



\newcommand{\CCZ}{\textbf{CCZ}}
\newcommand{\CCX}{\textbf{CCX}}


\newcounter{enumcirc}
\setcounter{enumcirc}{1} 
\counterwithin{enumcirc}{section}


\newcommand{\advanceday}[1][21]{%
\begingroup
\AdvanceDate[#1]%
\today%
\endgroup
}%


\newcommand{\subqCircEx}[2]{\begin{subfigure}[t]{0.5\textwidth}
        \stepcounter{enumcirc} \caption*{ (\alph{enumcirc}) #1} \centering 
        #2
    \end{subfigure}
}

\newcommand{\qCircEx}[4]{\begin{figure*}[h!]
    \centering
    \subqCircEx{#1}{#2}
    ~ 
    \subqCircEx{#3}{#4}
\end{figure*}
}

\newcommand{\qCircExfullline}[2]{\begin{figure*}[h!]
    \stepcounter{enumcirc} \caption*{ (\alph{enumcirc}) #1}
        \centering 
        #2
\end{figure*}
}

\section{Overview - Quantum States as Computational Resources.}
In the last lectures, we saw that quantum states can be considered as resources. In particular, we saw that shared $\textbf{EPR}$ pair ($\textbf{Bell}_{00}$) enables one:
\begin{enumerate}
    \item Transmit two classical bits by sending a single qubit, via the superdense-coding. 
    \item 'Teleoperate' a qubit by sending two classical bits. From an engineering point of view, it means that for having a complete quantum internet, it's enough to provide a mechanism to distribute $\textbf{EPR}$ pairs.
\end{enumerate}


\section{Superdense Encoding.} 
The idea behind superdense coding is that a local operation over $\ket{\mathbf{EPR}}=\ket{\beta_{00}}$, namely an operation on the partition held by Alice, sends it to any of the other Bell states. For example, $X \otimes I_{\text{Bob}} \EPR \rightarrow \frac{1}{\sqrt{2}}\left( \ket{01} + \ket{10} \right) = \ket{\beta_{10}} $. Thus, Alice can change the complete encoded state shared between Alice and Bob by acting only over her local system. Yet, as we have seen, for Bob to infer what that state is, he has to hold both qubits, otherwise, his local view is the uniformly mixed state over a single qubit. So the protocol works as follows:
\begin{enumerate}
  \item  We assume that Alice and Bob share an $\EPR$, each holding a single qubit.
  \item  Alice applies one of $I, X, Z, XZ$ on her qubit to transform the shared state to one of the following $\beta_{00}, \beta_{10}, \beta_{01}, \beta_{11}$ and sends it to Bob.
  \item Bob decodes the qubit pair by rotating the state into the computational basis and then measuring.
\end{enumerate}

In total, we have a protocol that, by sending a single qubit through the channel, passes two classical bits. Notice that any attempt to listen to the channel\footnote{The assumption that Alice and Bob initially held a valid \textbf{EPR} pair is important, yet much weaker than assuming they have a private key.} would reveal no information since, again, when squeezing the view into a single qubit, it seems uniformly mixed.



\section{Quantum Teleportation.}
Quantum teleportation is a gadget (method) to transfer a quantum state from one location to another, without the physical transfer of the underlying particles themselves. This is achieved through the consumption of $\mathbf{EPR}$ pairs.

    \begin{figure}[h]
        \centering 
\begin{quantikz}
  \lstick{$\ket{\psi}$} &  &  &  \ctrl{1} & \gate{H} & \meter{} &  & \ctrl{2} & &  &  & &  & &  &\\
  \lstick{$\ket{0}$} & \gate{H} & \ctrl{1} & \targ{} &  & \meter{} &  \ctrl{1}  & & & & &  &  &&  &\\
  \lstick{$\ket{0}$} &  & \targ{} &   &  &  & \targ{} & \gate{Z} & &  &  & &  &&  &%\rstick{\ket{\psi}}
\end{quantikz}
\caption{The teleportation gate. Note that at the beginning, the circuit initializes the $\EPR$ state. This is not standard, and usually, teleportation diagrams start by acting on an \textbf{EPR}.}
\end{figure}

For understanding the protocol, let's first examine a much simpler circuit. Consider the state given by the partial circuit obtained by first omitting the phase correction, and second by pulling the XORing of $\ket{\psi}$ and Alice's part into a third ancilla. The circuit is presented in \Cref{figure:partial_tel}.

Let's assume the measurement result is zero. Hence, we know that in the computational basis, Alice's \textbf{EPR} part agrees with $\ket{\psi}$, or in other words, if we measure the entire system in the computational basis, then the $\ket{\psi}$ bit would be equal to Alice's bit, and therefore would also be equal to Bob's bit. From here, we understand that the probability of Bob's bit being measured as zero equals the probability of $\ket{\psi}$ being measured as zero. 

What happens if the result measurement is $1$? In that case, we find that $\ket{\psi}$ disagrees with Alice's part and hence also disagrees with Bob's part. We can fix it by applying a Pauli correction, and that is the reason for the controlled XOR at the end of the teleportation.

    \begin{figure}[h]
        \centering 
\begin{quantikz}
  \lstick{$\ket{\psi}$} &  \ctrl{1} & &  & &  &  &  &  & &  &  & &  & &  &\\
  \lstick{$\ket{0}$} &  \targ{} & & \targ{} & & \meter{} &   & & & & &  &  &&  & &\\
  \lstick{$\ket{0}$} & \gate{H} & \ctrl{1} & \ctrl{-1} &  &  &    & & & & &  &  &&  & &\\
  \lstick{$\ket{0}$} &  & \targ{} &   &  &  &  &  & &  &  & &  &&  & & %\rstick{\ket{\psi}}
\end{quantikz}
\caption{ Simple circuit to undersatnad teleportation concept.  }   
      \label{figure:partial_tel}
\end{figure}

In the teleportation protocol, the state progresses up to measurements as:
\begin{equation*}
  \begin{split}
      \ket{\psi} \otimes &\EPR \left( \alpha\ket{0} + \beta \ket{1} \right)  \\ 
  \rightarrow  &  \frac{1}{\sqrt{2}} \alpha \ket{000} +  \frac{1}{\sqrt{2}} \beta  \ket{110} \frac{1}{\sqrt{2}}  + \alpha \ket{011} + \frac{1}{\sqrt{2}} \beta  \ket{101} \\ 
  \rightarrow  &  \ \frac{1}{2} \alpha \ket{000} +  \frac{1}{2} \alpha \ket{100} + 
  \frac{1}{2} \beta  \ket{010}   -  \frac{1}{2} \beta  \ket{110} \\ &  + 
  \frac{1}{2} \alpha \ket{011} + \frac{1}{2} \alpha \ket{111} + 
  \frac{1}{2} \beta  \ket{001} - \frac{1}{2} \beta  \ket{101}  \\ 
  = & \frac{1}{2}\ket{00} \ket{\psi} + \frac{1}{2} \ket{01} X\ket{\psi} + \frac{1}{2} \ket{10} Z\ket{\psi} + \frac{1}{2}\ket{11}XZ\ket{\psi} 
  \end{split}
\end{equation*}
Where the first arrow stands for the Xoring operation, and the second stands for the Hadamard.


\section{Gate Teleportation.}
Gate teleportation is a method to 'encode' operations by quantum states. At a high level, given a precomputed state, it allows one to apply an operation (gate) using (probably) simpler gates. The precomputed states are called \textbf{Magic States}.
\subsection{Leading Example: $T$-Teleportation.}
Recall that the Clifford\footnote{Generated by $H, S$ and $CX$} + T is a universal quantum gate set. The Clifford group alone is considered, from the computer science point of view, a simple/weak computational class since it can be classically simulated\footnote{And conjectured to be strictly weaker than \textbf{P}}. Yet, we will see that given access to the magic $\ket{T} = T\ket{+}$, one can simulate the $T$ gate using only Clifford gates and measurements.
    \begin{figure}[h]
        \centering 
        \begin{quantikz}
        \lstick{$\ket{\psi}$} & \ctrl{1}  & \gate{S} &  &&&&&&&&&&&&& \\
\lstick{$\ket{T}$} & \targ{} & \meter{} \wire[u][1]{c}    \\
        \end{quantikz}
        \caption{ Simulating the $T$-gate, using the $\ket{T}$ magic state. }   
\label{fig:magic}
\end{figure}



In \Cref{fig:magic}, we have the $T$-teleportation gadget. The state progresses up to the measurement as follows:
\begin{equation*}
    \begin{split}
        \left(\sum_{x}\alpha_{x}\ket{x}\right)\otimes\frac{1}{\sqrt{2}} \left(  \ket{0} + e^{i\frac{\pi}{4}}\ket{1}\right) & \overbrace{  \mapsto }^{ \textbf{CX} } \sum_{x,y}\frac{1}{\sqrt{2}}\alpha_{x}\ket{x}\ket{x\oplus y}e^{i\frac{\pi}{4} y} \\ 
        & \mapsto \ \ \begin{cases}
         \sum_{x}\alpha_x\ket{x}e^{i\frac{\pi}{4}x} = T\ket{\psi}   & \text{measured } 0 \\
           \sum_{x}\alpha_x\ket{x}e^{i\frac{\pi}{4}\bar{x}} & \text{measured } 1
        \end{cases} \\ 
        & \overbrace{  \mapsto }^{ \textbf{CS} } \begin{cases}
          T\ket{\psi}    \\
           \sum_{x}\alpha_x\ket{x}e^{i\left( \frac{\pi}{4}\bar{x} + \frac{\pi}{2}x \right)} =  \sum_{x}\alpha_x\ket{x}e^{i\frac{\pi}{4}}e^{i\left( \frac{\pi}{4}\bar{x} + \frac{\pi}{4}x \right)}
        \end{cases} \\ 
        & = \ \ \begin{cases}
          T\ket{\psi}    \\
           e^{i\frac{\pi}{4} } \sum_{x}\alpha_x\ket{x}e^{i\frac{\pi}{4}} = e^{i\frac{\pi}{4} } T\ket{\psi}
        \end{cases} 
    \end{split}
\end{equation*}


\section{Uhlmann's Theorem}
Fidelity of pure quantum states is defined as the absolute square of the inner product between two quantum states. It measures the similarity or overlap between two quantum states, indicating how close they are to being identical. We define the fidelity of a pure state $\ket{\psi}$ with a mixed one $\rho$ as the expectation of the fidelity of the pure state drawn from the distribution induced by $\rho$. In this section we are about to define the fidelity of two mixed states $\sigma$ and $\rho$.
\begin{definition}
The fidelity of $\rho$ and $\sigma$ is the maximal fidelity between chosen purifications of them.
\end{definition}

\begin{theorem}[Uhlmann's Theorem]
Let $\rho, \sigma$ be mixed states, and let's denote by $\ket{\psi_\rho}$, $\ket{\psi_\sigma}$ arbitrary purifications of $\rho, \sigma$. Then their fidelity equals:
  \begin{equation*}
    \begin{split}
      F(\sigma,\rho) = \max_{\ket{\psi_\rho}, \ket{\psi_\sigma}} \left| \braket{\psi_\rho|\psi_\sigma} \right|^2 
    \end{split}
  \end{equation*}
\end{theorem}

For proving it, we will need the following definition and claims:
\begin{definition}
  Denote by $\ket{\Omega}$ the sate:  $\ket{\Omega}= \sum_{i}{\ket{i,i}}$
\end{definition}

\begin{claim} For any matrices $A, B$ (with matched dimensions), it holds that:
  \begin{equation*}
    \begin{split}
    \braket{\Omega| A \otimes B  | \Omega} = \mathbf{Tr} AB^\dagger
    \end{split}
  \end{equation*}
\end{claim}
\begin{proof}
  \begin{equation*}
    \begin{split}
    \braket{\Omega| A \otimes B  | \Omega} = \sum_{ij}{ \braket{ i,i | AB | j ,j } } &=  \sum_{ij}{ \braket{ i| A | j} \braket{i | B | j } } =  \sum_{ij}{ \braket{ i| A | j} \braket{j | B^\dagger | i } } \\ 
      & = \sum_{i}{ \braket{i | A B^\dagger | i } } = \mathbf{Tr} AB^\dagger
    \end{split}
  \end{equation*}
\end{proof}

\begin{claim} For any square matrix $A$:
  \begin{equation*}
    \begin{split}
      \max_{U \in \mathcal{U}} \mathbf{Tr} AU = \mathbf{Tr} \sqrt{ A^\dagger A } 
    \end{split}
  \end{equation*}
The proof is left as an exercise.
\end{claim}

\subsection{Uhlmann's Theorem Proof.} 

Let: $\{\ket{\psi_i}\}$ and $\{\ket{\psi_i^\prime}\}$ be the eigenstates of $\rho$ and $\sigma$. Any purifications can be written as follows:
\begin{equation*}
  \begin{split}
    \ket{\psi_\rho} & = \sum_{i}{ \left( \rho^{\frac{1}{2}}\ket{\psi_i} \right) \ket{i} } = \sum_{i}{ \left( \rho^{\frac{1}{2}} U_{\rho} \ket{i} \right) \ket{i} }  =  \left( \rho^{\frac{1}{2}} U_{\rho} \right) \otimes I \ket{ \Omega } \\ 
  \ket{\psi_\sigma} & = \sum_{i}{ \left( \sigma^{\frac{1}{2}}\ket{\psi^\prime_i} \right) \ket{i^\prime} } =  
  \sum_{i}{ \left( \sigma^{\frac{1}{2}} U_{\sigma} \ket{i} \right)  V \ket{i} }  =  \left( \sigma^{\frac{1}{2}} U_{\sigma} \right) \otimes V \ket{\Omega} 
  \end{split}
\end{equation*}
Where $U_{\rho},U_{\sigma}$ and $V$ are unitireis. 



\begin{equation*}
  \begin{split}
    \max | \braket{ \psi_\rho | \psi_\sigma } |^2  & = \max  | \braket{\Omega |   \left( U_{\rho}^{\dagger} \rho^{\frac{1}{2}}  \right) \otimes I   \left( \sigma^{\frac{1}{2}} U_{\sigma} \right) \otimes V     | \Omega}  |^{2} \\
  & = \max |     \mathbf{Tr} \left[  \left( U_{\rho}^{\dagger} \rho^{\frac{1}{2}}   \sigma^{\frac{1}{2}} U_{\sigma} \right)  V^\dagger\right]    |^{2} \\
  & = \max |     \mathbf{Tr} \left[  \rho^{\frac{1}{2}}   \sigma^{\frac{1}{2}}   V^\dagger\right]    |^{2} \\
  & \le \left|   \mathbf{Tr} \sqrt{      \rho^{\frac{1}{2}} \sigma^{\frac{1}{2}} \sigma^{\frac{1}{2}}\rho^{\frac{1}{2}}   }   \right|^{2} = \left|   \mathbf{Tr} \sqrt{      \rho^{\frac{1}{2}} \sigma \rho^{\frac{1}{2}}   }   \right|^{2}  \\
  \end{split}
\end{equation*}

\section{Monotonicity of Fidelity.}
Let $\rho_{AB}, \sigma_{AB} \in \mathcal{D}(\mathcal{H}_A \otimes \mathcal{H}_B)$. Then the fidelity is non-decreasing with respect to the partial trace:
\begin{equation*}
  \begin{split}
  F(\rho_{AB}, \sigma_{AB}) \leq F(\rho_A, \sigma_A),
  \end{split}
\end{equation*}
where $\rho_A = \mathrm{Tr}_B\{\rho_{AB}\}$ and $\sigma_A = \mathrm{Tr}_B\{\sigma_{AB}\}$.

\begin{proof}

Consider fixed purifications $\ket{\psi}_{RAB}$ and $\ket{\phi}_{RAB}$ of $\rho_{AB}$ and $\sigma_{AB}$, respectively, which also purify $\rho_A$ and $\sigma_A$. By Uhlmann’s theorem,
\[
F(\rho_{AB}, \sigma_{AB}) = \max_{U_R} \left| \braket{\psi | U_R \otimes I_A \otimes I_B | \phi} \right|^2.
\]
On the other hand, since $U_R \otimes I_A$ is a subset of the larger class of unitaries $U_{RB}$ on $RB$,
\[
F(\rho_A, \sigma_A) = \max_{U_{RB}} \left| \braket{\psi | U_{RB} \otimes I_A | \phi} \right|^2 \geq F(\rho_{AB}, \sigma_{AB}).
\]
Thus, we conclude that
\[
F(\rho_{AB}, \sigma_{AB}) \leq F(\rho_A, \sigma_A).
\]
\end{proof}
Notice that $\ket{i}\bra{j}$ is unitray since. 


\section{ $ \ket{\mathbf{EPR} }$ Distillation / Entanglement Purification.  }
Distillation of entanglement is a process in quantum information theory where a mixed entangled state is transformed into a more pure form of entanglement. This is achieved by using local operations and classical communication (LOCC) to extract a smaller number of highly entangled pairs from a larger number of weakly entangled pairs. The goal is to maximize the quality of entanglement, making it more suitable for quantum communication and computation tasks.

The process involves multiple copies of a mixed entangled state, which are manipulated to increase the fidelity of the entanglement. Distillation protocols, such as the Bennett-Brassard protocol, are used to achieve this transformation. The distilled entangled states are more robust and can be used for tasks like quantum teleportation and superdense coding, where high-quality entanglement is crucial for optimal performance.

    \begin{figure}[h]
        \centering 
\begin{quantikz}
  \lstick{$\ket{\psi}$} & \ctrl{1} & & & & & & & & & & & & \\
  \lstick{$\ket{0}$} &  \targ{} & &  \meter{} & & & & & & & & & &\\
  \lstick{$\ket{\psi}$} & \ctrl{1} & & & & & & & & & & & & \\
  \lstick{$\ket{0}$} &  \targ{} & &  \meter{} & & & & & & & & & &
\end{quantikz}
     \caption{ Measuring the single-qubit state $\ket{\psi}$ at the $\{\ket{+}, \ket{-} \}$ base. }   
\end{figure}


\begin{equation*}
  \begin{split}
    \rho = p\ket{\beta_{00}}\bra{\beta_{00}} + \frac{1-p}{3}\sum_{j\neq 00}{\ket{\beta_{j}}\bra{\beta_{j} }}
  \end{split}
\end{equation*}
The density matrix over each qubit is $\frac{1}{2}I$, so the measurement is equivalent to flipping coins and asking if the first pair and second pair are the same. Thus, the success probability is $\frac{1}{4}$. Now the state that is left is the projection of $\rho$ into the space in which both the bits of Alice and Bob are equal, namely: 


\begin{equation*}
  \begin{split}
    & \frac{1}{4} \inb{ \left(  \left(\ket{00} \pm \ket{11} \right) \otimes \left(\ket{00} \pm \ket{11} \right) \right) }  \rightarrow \left( \ket{0000} + \ket{1111} \right)  \\ 
    & \frac{1}{4}  \left(  \left(\ket{00} \pm \ket{11} \right) \otimes \left(\ket{00} \mp \ket{11} \right) \right)  \rightarrow \left( \ket{0000} - \ket{1111} \right)  \\ 
    & \frac{1}{4}  \left(  \left(\ket{00} \pm \ket{11} \right) \otimes \left(\ket{01} \pm \ket{01} \right) \right)  \rightarrow \emptyset  \\ 
    & \frac{1}{4}  \left(  \left(\ket{01} \pm \ket{10} \right) \otimes \left(\ket{01} \pm \ket{10} \right) \right)  \rightarrow \left( \ket{0101} + \ket{0101} \right)  \\ 
    & \frac{1}{4}  \left(  \left(\ket{01} \pm \ket{10} \right) \otimes \left(\ket{01} \mp \ket{10} \right) \right)  \rightarrow \left( \ket{0101} - \ket{0101} \right)  
  \end{split}
\end{equation*}


\begin{equation*}
  \begin{split}
    \inb{p^2} + 2\frac{1}{3} p(1-p)+ \inb{\frac{1}{9}(1-p)^2} + 4\frac{1}{9}(1-p)^2 
  \end{split}
\end{equation*}


\begin{equation*}
  \begin{split}
    p^\prime \leftarrow \frac{ \inb{p^2} + \inb{\frac{1}{9}(1-p)^2} }{ \inb{p^2} + 2\frac{1}{3} p(1-p)+\inb{ \frac{1}{9}(1-p)^2} + 4\frac{1}{9}(1-p)^2  }
  \end{split}
\end{equation*}





\section{Magic State Distillation.}

\textbf{Question.} Can we purify noisy magic states into high-fidelity ones, using only Clifford operations?

Magic state distillation is a procedure that uses many copies of noisy magic states, plus only Clifford gates and measurements, to produce fewer, higher-fidelity magic states.

\ifdefined\DEBUG
\subsection{Extends it.}

Let's extends it to a general gate. First create $\ket{\textbf{GHZ}_{2n}}$ state, then 

Let's split upon the measurement result. 
\begin{enumerate}
    \item If we measured $0$, means the states 'agreed' in the computational base. 
      \begin{equation*}
    \begin{split}
          \ket{\psi} \otimes \left( \sum_x\ket{x}\otimes U\ket{x} \right)
    \end{split}
\end{equation*}
\end{enumerate}

\else
\fi


\printbibliography 

\end{document}

